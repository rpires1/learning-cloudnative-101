(window.webpackJsonp=window.webpackJsonp||[]).push([[122],{"013z":function(e,t,a){"use strict";var n=a("q1tI"),r=a.n(n),c=a("NmYn"),i=a.n(c),o=a("Wbzz"),b=a("Xrax"),l=a("k4MR"),p=a("TSYQ"),s=a.n(p),m=a("QH2O"),u=a.n(m),d=a("qKvR"),O=function(e){var t,a=e.title,n=e.theme,r=e.tabs,c=void 0===r?[]:r;return Object(d.b)("div",{className:s()(u.a.pageHeader,(t={},t[u.a.withTabs]=c.length,t[u.a.darkMode]="dark"===n,t))},Object(d.b)("div",{className:"bx--grid"},Object(d.b)("div",{className:"bx--row"},Object(d.b)("div",{className:"bx--col-lg-12"},Object(d.b)("h1",{id:"page-title",className:u.a.text},a)))))},N=a("BAC9"),g=function(e){var t=e.relativePagePath,a=e.repository,n=Object(o.useStaticQuery)("1364590287").site.siteMetadata.repository,r=a||n,c=r.baseUrl,i=r.subDirectory,b=c+"/edit/"+r.branch+i+"/src/pages"+t;return c?Object(d.b)("div",{className:"bx--row "+N.row},Object(d.b)("div",{className:"bx--col"},Object(d.b)("a",{className:N.link,href:b},"Edit this page on GitHub"))):null},h=a("FCXl"),j=a("dI71"),A=a("I8xM"),E=function(e){function t(){return e.apply(this,arguments)||this}return Object(j.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.title,a=e.tabs,n=e.slug,r=n.split("/").filter(Boolean).slice(-1)[0],c=a.map((function(e){var t,a=i()(e,{lower:!0,strict:!0}),c=a===r,b=new RegExp(r+"/?(#.*)?$"),l=n.replace(b,a);return Object(d.b)("li",{key:e,className:s()((t={},t[A.selectedItem]=c,t),A.listItem)},Object(d.b)(o.Link,{className:A.link,to:""+l},e))}));return Object(d.b)("div",{className:A.tabsContainer},Object(d.b)("div",{className:"bx--grid"},Object(d.b)("div",{className:"bx--row"},Object(d.b)("div",{className:"bx--col-lg-12 bx--col-no-gutter"},Object(d.b)("nav",{"aria-label":t},Object(d.b)("ul",{className:A.list},c))))))},t}(r.a.Component),f=a("MjG9"),C=a("CzIb"),T=a("Asxa"),S=a("OIbQ"),R=a.n(S),k=function(e){var t=e.date,a=new Date(t);return t?Object(d.b)(T.c,{className:R.a.row},Object(d.b)(T.a,null,Object(d.b)("div",{className:R.a.text},"Page last updated: ",a.toLocaleDateString("en-GB",{day:"2-digit",year:"numeric",month:"long"})))):null};t.a=function(e){var t=e.pageContext,a=e.children,n=e.location,r=e.Title,c=t.frontmatter,p=void 0===c?{}:c,s=t.relativePagePath,m=t.titleType,u=p.tabs,N=p.title,j=p.theme,A=p.description,T=p.keywords,S=p.date,R=Object(C.a)().interiorTheme,x=Object(o.useStaticQuery)("2456312558").site.pathPrefix,y=x?n.pathname.replace(x,""):n.pathname,P=u?y.split("/").filter(Boolean).slice(-1)[0]||i()(u[0],{lower:!0}):"",I=j||R;return Object(d.b)(l.a,{tabs:u,homepage:!1,theme:I,pageTitle:N,pageDescription:A,pageKeywords:T,titleType:m},Object(d.b)(O,{title:r?Object(d.b)(r,null):N,label:"label",tabs:u,theme:I}),u&&Object(d.b)(E,{title:N,slug:y,tabs:u,currentTab:P}),Object(d.b)(f.a,{padded:!0},a,Object(d.b)(g,{relativePagePath:s}),Object(d.b)(k,{date:S})),Object(d.b)(h.a,{pageContext:t,location:n,slug:y,tabs:u,currentTab:P}),Object(d.b)(b.a,null))}},BAC9:function(e,t,a){e.exports={bxTextTruncateEnd:"EditLink-module--bx--text-truncate--end--2pqje",bxTextTruncateFront:"EditLink-module--bx--text-truncate--front--3_lIE",link:"EditLink-module--link--1qzW3",row:"EditLink-module--row--1B9Gk"}},I8xM:function(e,t,a){e.exports={bxTextTruncateEnd:"PageTabs-module--bx--text-truncate--end--267NA",bxTextTruncateFront:"PageTabs-module--bx--text-truncate--front--3xEQF",tabsContainer:"PageTabs-module--tabs-container--8N4k0",list:"PageTabs-module--list--3eFQc",listItem:"PageTabs-module--list-item--nUmtD",link:"PageTabs-module--link--1mDJ1",selectedItem:"PageTabs-module--selected-item--YPVr3"}},NR3j:function(e,t,a){"use strict";a.r(t),a.d(t,"_frontmatter",(function(){return b})),a.d(t,"default",(function(){return s}));var n=a("wx14"),r=a("zLVn"),c=(a("q1tI"),a("7ljp")),i=a("013z"),o=(a("qKvR"),["components"]),b={},l={_frontmatter:b},p=i.a;function s(e){var t=e.components,a=Object(r.a)(e,o);return Object(c.b)(p,Object(n.a)({},l,a,{components:t,mdxType:"MDXLayout"}),Object(c.b)("h2",null,"Tekton and ArgoCD Integration"),Object(c.b)("p",null,"This tutorial shows the concept of seperation of concerns in DevOps.\nThe project is setup in 3 repos (not all teams will have write access to all of them)"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"This git repo only contains the pipeline setup"),Object(c.b)("ul",{parentName:"li"},Object(c.b)("li",{parentName:"ul"},Object(c.b)("a",{parentName:"li",href:"https://github.com/ibm-cloud-architecture/tutorial-tekton-argocd-pipeline"},"https://github.com/ibm-cloud-architecture/tutorial-tekton-argocd-pipeline")))),Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"The git repo that contains only the application source code"),Object(c.b)("ul",{parentName:"li"},Object(c.b)("li",{parentName:"ul"},Object(c.b)("a",{parentName:"li",href:"https://github.com/ibm-cloud-architecture/tutorial-tekton-argocd-code"},"https://github.com/ibm-cloud-architecture/tutorial-tekton-argocd-code")))),Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"The git repo that contains only the infrastructure manifests (yaml)"),Object(c.b)("ul",{parentName:"li"},Object(c.b)("li",{parentName:"ul"},Object(c.b)("a",{parentName:"li",href:"https://github.com/ibm-cloud-architecture/tutorial-tekton-argocd-infra"},"https://github.com/ibm-cloud-architecture/tutorial-tekton-argocd-infra")))),Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"We will be using Tekton to build the container image, and update the Infra Git repo.")),Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"We will be using ArgoCD to deploy the application from the infra git repo"))),Object(c.b)("span",{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"818px"}},"\n      ",Object(c.b)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"31.59722222222222%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABKElEQVQY021RuU4DMRDdH6ak5SP4Dor0NCAhAk3oSBQUEm3wsg7rPeI9fD/GjiIQYqTReObN+ZwhSvAwxpAJya0ZB1tuERJEmLWAd/grnjBHSZpgPSkY2SN7Gz1K5WC1gux7DOOAiguwnENrjXEcYZTCl7JYDR4hBMimoQU0lKY6PsPL+h3zuz3U8xOyq63GrJyguwairiCqA5SKzSXatkVRlvCDxG1xxOXG0MAJm/k9quID/WjAFxcQxSPV0Ja1QLbc7cFFnU46iB6MS1hr0naxcVRD77o7YpWzdCrLc0y0uXMO7LNB10k4b9FPEzJPxdae+Ll5ULieHSM7KRYLkkYe4wCiwxKfns4+Y3F4pCEkwgMynGyS9U5g8Vqc/ikl/ehv+S9+9r8BMYrNQ7ZZBPoAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}}),"\n  ",Object(c.b)("img",{parentName:"span",className:"gatsby-resp-image-image",alt:"overview-diagram",title:"overview-diagram",src:"/static/e0f59cda603cd30cfc3a5138da9d879c/96d67/tekton-argocd.png",srcSet:["/static/e0f59cda603cd30cfc3a5138da9d879c/7fc1e/tekton-argocd.png 288w","/static/e0f59cda603cd30cfc3a5138da9d879c/a5df1/tekton-argocd.png 576w","/static/e0f59cda603cd30cfc3a5138da9d879c/96d67/tekton-argocd.png 818w"],sizes:"(max-width: 818px) 100vw, 818px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"}),"\n    "),Object(c.b)("h2",null,"Setup Git repositories"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"Get a copy of the devops git repository and change directory",Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/ibm-cloud-architecture/tutorial-tekton-argocd-pipeline\ncd tutorial-tekton-argocd-pipeline\n"))),Object(c.b)("li",{parentName:"ul"},"Create a new code git repository using this repo as ",Object(c.b)("a",{parentName:"li",href:"https://github.com/ibm-cloud-architecture/tutorial-tekton-argocd-code/generate"},"template")),Object(c.b)("li",{parentName:"ul"},"Create a new infra git repository using this repo as ",Object(c.b)("a",{parentName:"li",href:"https://github.com/ibm-cloud-architecture/tutorial-tekton-argocd-infra/generate"},"template"))),Object(c.b)("h2",null,"Setup Cluster"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"You need an OpenShift 4 cluster, you can use ",Object(c.b)("a",{parentName:"li",href:"https://access.redhat.com/documentation/en-us/red_hat_codeready_containers"},"CodeReadyContainers (CRC)"),", ",Object(c.b)("a",{parentName:"li",href:"https://learn.openshift.com/playgrounds/openshift42/"},"OpenShift PlayGround"),", or OpenShift from a cloud provider like IBM Cloud"),Object(c.b)("li",{parentName:"ul"},"Install OpenShift Operators",Object(c.b)("ul",{parentName:"li"},Object(c.b)("li",{parentName:"ul"},"Install OpenShift Pipeline Operator",Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"oc apply -f operators/tekton-operator.yaml\n"))),Object(c.b)("li",{parentName:"ul"},"Install ",Object(c.b)("a",{parentName:"li",href:"https://github.com/disposab1e/argocd-operator-helm"},"ArgoCD (HELM) Operator")," on the ",Object(c.b)("inlineCode",{parentName:"li"},"argocd")," namespace",Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"oc apply -f operators/argocd-operator.yaml\n")),"When installing the tutorial, make sure you wait until the argocd-operator is finished before installing the argocd-cr..or it will fail. You can do this:",Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"oc get ClusterServiceVersion -n argocd\nNAME                                   DISPLAY                        VERSION   REPLACES   PHASE\nargocd-operator.v0.0.8                 Argo CD                        0.0.8                Succeeded\n")),"and wait for the “succeeded” to come up before proceeding.",Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"oc apply -f operators/argocd-cr.yaml\n")),"and wait for the argocd server Pod to be running",Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre"},"oc get pods -n argocd -l app.kubernetes.io/name=example-argocd-server\n")),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre"},"NAME                                     READY   STATUS    RESTARTS   AGE\nexample-argocd-server-57c4fd5c45-zf4q6   1/1     Running   0          115s\n")))))),Object(c.b)("h2",null,"Setup CLIs"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},Object(c.b)("a",{parentName:"li",href:"https://github.com/tektoncd/cli#installing-tkn"},"Install Tekton CLI")," ",Object(c.b)("inlineCode",{parentName:"li"},"tkn")),Object(c.b)("li",{parentName:"ul"},Object(c.b)("a",{parentName:"li",href:"https://argoproj.github.io/argo-cd/cli_installation/"},"Install ArgoCD CLI")," ",Object(c.b)("inlineCode",{parentName:"li"},"argocd"))),Object(c.b)("h2",null,"Setup target Namespace"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"Create a new namespace/project",Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"oc new-project tekton-argocd\n"))),Object(c.b)("li",{parentName:"ul"},"Set the environment variable ",Object(c.b)("inlineCode",{parentName:"li"},"NAMESPACE"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},'export NAMESPACE=$(oc project -q)\necho "NAMESPACE set to $NAMESPACE"\n')))),Object(c.b)("h2",null,"Create ArgoCD Application"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"Set an environment variable ",Object(c.b)("inlineCode",{parentName:"p"},"ARGOCD_URL")," using the route"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},'export ARGOCD_NAMESPACE="argocd"\nexport ARGOCD_SERVER=$(oc get route example-argocd-server -n $ARGOCD_NAMESPACE -o jsonpath=\'{.spec.host}\')\nexport ARGOCD_URL="https://$ARGOCD_SERVER"\necho ARGOCD_URL=$ARGOCD_URL\necho ARGOCD_SERVER=$ARGOCD_SERVER\n'))),Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"Login into the UI."),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"open $ARGOCD_URL\n"))),Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"Use ",Object(c.b)("inlineCode",{parentName:"p"},"admin")," as the username and get the password with the following command"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"oc get secret example-argocd-cluster -n $ARGOCD_NAMESPACE -o jsonpath='{.data.admin\\.password}' | base64 -d\n")),Object(c.b)("p",{parentName:"li"},"  For example the output is similar to this:"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre"},"tyafMb7BNvO0kP9eizx3CojrK8pYJFQq\n")),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"export ARGOCD_PASSWORD=$(oc get secret example-argocd-cluster -n $ARGOCD_NAMESPACE -o jsonpath='{.data.admin\\.password}' | base64 -d)\n"))),Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"Login into ArgoCD"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"argocd login --username admin --password $ARGOCD_PASSWORD $ARGOCD_SERVER\n")),Object(c.b)("p",{parentName:"li"},"Note: if you have problems with DNS using CRC, you might need to edit ",Object(c.b)("inlineCode",{parentName:"p"},"/etc/hosts")," and add entry for the ",Object(c.b)("inlineCode",{parentName:"p"},"$ARGOCD_SERVER")," with IP Address from ",Object(c.b)("inlineCode",{parentName:"p"},"crc ip"))),Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"Create the App in ArgoCD using your own Infra git repository"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},'export GIT_REPOSITORY_URL="https://github.com/ibm-cloud-architecture/tutorial-tekton-argocd-infra"\n')),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},'export ARGOCD_APP=$(oc project -q)\nexport GIT_MANIFEST_DIR="yamls/ocp"\n')),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"argocd app create $ARGOCD_APP \\\n--project default \\\n--repo $GIT_REPOSITORY_URL \\\n--path $GIT_MANIFEST_DIR \\\n--dest-server https://kubernetes.default.svc \\\n--dest-namespace $NAMESPACE \\\n--sync-policy automated \\\n--self-heal \\\n--auto-prune\n")),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre"},"application 'tekton-argocd' created\n")))),Object(c.b)("h2",null,"Build Image with Tekton"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"Deploy the pipeline assets, edit the ",Object(c.b)("inlineCode",{parentName:"p"},"pipelines/git.yaml")," and ",Object(c.b)("inlineCode",{parentName:"p"},"pipelines/pipeline-build-git.yaml")," and use your own Code and Infra git repositories respectively."),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"oc apply -f pipeline/ -n $NAMESPACE\n")),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"tkn resources ls -n $NAMESPACE\n")),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre"},"NAME     TYPE    DETAILS\nsource   git     url: https://github.com/ibm-cloud-architecture/tutorial-tekton-argocd-code\nimage    image   url: image-registry.openshift-image-registry.svc:5000/$NAMESPACE/app\n")),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"tkn task ls -n $NAMESPACE\n")),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre"},"NAME        AGE\nbuild       36 seconds ago\nbuild-git   36 seconds ago\n")),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"tkn pipeline ls -n $NAMESPACE\n")),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre"},"NAME        AGE              LAST RUN   STARTED   DURATION   STATUS\nbuild-git   17 seconds ago   ---        ---       ---        ---\n"))),Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"Run the build task to test image build only"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"tkn task start build \\\n  -i image=image \\\n  -i source=source \\\n  --showlog \\\n  -s pipeline \\\n  -n $NAMESPACE\n")),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"tkn taskrun ls -n $NAMESPACE\n")),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre"},"NAME              STARTED         DURATION    STATUS\nbuild-run-c4d4r   4 minutes ago   2 minutes   Succeeded\n")),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"oc get imagestream -n $NAMESPACE\n")),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre"},"NAME   IMAGE REPOSITORY                                                     TAGS      UPDATED\napp    image-registry.openshift-image-registry.svc:5000/tekton-argocd/app   b711ac7   About a minute ago\n")))),Object(c.b)("h2",null,"Update Infrastructure Git repo"),Object(c.b)("h3",null,"Configure Github Personal Access Token"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"For your CI pipeline to connect to and use your GitHub repo, it will need a ",Object(c.b)("a",{parentName:"p",href:"https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line"},"GitHub personal access token")," with ",Object(c.b)("inlineCode",{parentName:"p"},"public_repo")," and ",Object(c.b)("inlineCode",{parentName:"p"},"write:repo_hook")," scopes.")),Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"Navigate to ",Object(c.b)("a",{parentName:"p",href:"https://github.com/settings/tokens"},"Developer Settings")," and generate a new token; name it something like “CI pipeline”")),Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"Select ",Object(c.b)("inlineCode",{parentName:"p"},"public_repo")," scope to enable git clone")),Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"Select ",Object(c.b)("inlineCode",{parentName:"p"},"write:repo_hook")," scope so the pipeline can create a web hook")),Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"The GitHub UI will never again let you see this token, so be sure to ",Object(c.b)("strong",{parentName:"p"},"save the token")," in your password manager or somewhere safe that you can access later on")),Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"Create the secret for the Infra repository, replace ",Object(c.b)("inlineCode",{parentName:"p"},"<GIT_USERNAME>")," and ",Object(c.b)("inlineCode",{parentName:"p"},"<GIT_TOKEN>"),", keep the quotes"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"export GIT_USERNAME='<GIT_USERNAME>'\nexport GIT_TOKEN='<GIT_TOKEN>'\n")),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},'oc create secret generic git-infra-secret \\\n  --from-literal=username="$GIT_USERNAME" \\\n  --from-literal=token="$GIT_TOKEN" \\\n  -n $NAMESPACE\n'))),Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"Run Pipeline to Build Image and Update Infra Git repo"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"tkn pipeline start build-git \\\n            --showlog \\\n            -r source=source \\\n            -r image=image \\\n            -s pipeline \\\n            -n $NAMESPACE\n")),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"tkn pipeline ls -n $NAMESPACE\n")),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre"},"NAME        AGE             LAST RUN              STARTED         DURATION   STATUS\nbuild-git   2 minutes ago   build-git-run-rdhmj   2 minutes ago   1 minute   Succeeded\n")))),Object(c.b)("h2",null,"Extra Credit: Create Git Webhook"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"This is only possible if your OpenShift cluster is accessible from the the github server (ie github.com)")),Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"Create a WebHook for the Code Git repo"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"oc apply -f triggers/ -n $NAMESPACE\n")),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"oc create route edge --service=el-cicd -n $NAMESPACE\n")),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"export GIT_WEBHOOK_URL=$(oc get route el-cicd -o jsonpath='{.spec.host}' -n $NAMESPACE)\necho \"https://$GIT_WEBHOOK_URL\"\n"))),Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"Set the ",Object(c.b)("inlineCode",{parentName:"p"},"GIT_REPO_NAME")," to name of the Code Git repo like ",Object(c.b)("inlineCode",{parentName:"p"},"tutorial-tekton-argocd-code")),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"export GIT_REPO_NAME='<GIT_REPO_NAME>'\n"))),Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"Set the ",Object(c.b)("inlineCode",{parentName:"p"},"GIT_REPO_OWNER")," to name of the Code Git repo like ",Object(c.b)("inlineCode",{parentName:"p"},"ibm-cloud-architecture")),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},"export GIT_REPO_OWNER='<GIT_REPO_OWNER>'\n"))),Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},"Run curl to create the web hook"),Object(c.b)("pre",{parentName:"li"},Object(c.b)("code",{parentName:"pre",className:"language-bash"},'curl -v -X POST -u $GIT_USERNAME:$GIT_TOKEN \\\n-d "{\\"name\\": \\"web\\",\\"active\\": true,\\"events\\": [\\"push\\"],\\"config\\": {\\"url\\": \\"https://$GIT_WEBHOOK_URL\\",\\"content_type\\": \\"json\\",\\"insecure_ssl\\": \\"0\\"}}" \\\n-L https://api.github.com/repos/$GIT_REPO_OWNER/$GIT_REPO_NAME/hooks\n')))),Object(c.b)("p",null,"Make a change on the Code repository, and verify that Github sent the WebHook to the event listener, and that the Pipeline runs in OpenShift Console"))}s.isMDXComponent=!0},OIbQ:function(e,t,a){e.exports={bxTextTruncateEnd:"last-modified-date-module--bx--text-truncate--end--123zi",bxTextTruncateFront:"last-modified-date-module--bx--text-truncate--front--3xeKz",text:"last-modified-date-module--text--24m-4",row:"last-modified-date-module--row--2BquN"}},QH2O:function(e,t,a){e.exports={bxTextTruncateEnd:"PageHeader-module--bx--text-truncate--end--mZWeX",bxTextTruncateFront:"PageHeader-module--bx--text-truncate--front--3zvrI",pageHeader:"PageHeader-module--page-header--3hIan",darkMode:"PageHeader-module--dark-mode--hBrwL",withTabs:"PageHeader-module--with-tabs--3nKxA",text:"PageHeader-module--text--o9LFq"}}}]);
//# sourceMappingURL=component---src-pages-projects-project-cicd-solution-mdx-0f8c9510edd45463efaf.js.map