(window.webpackJsonp=window.webpackJsonp||[]).push([[121],{"013z":function(e,t,a){"use strict";var i=a("q1tI"),n=a.n(i),r=a("NmYn"),o=a.n(r),l=a("Wbzz"),c=a("Xrax"),s=a("k4MR"),b=a("TSYQ"),p=a.n(b),u=a("QH2O"),m=a.n(u),d=a("qKvR"),g=function(e){var t,a=e.title,i=e.theme,n=e.tabs,r=void 0===n?[]:n;return Object(d.b)("div",{className:p()(m.a.pageHeader,(t={},t[m.a.withTabs]=r.length,t[m.a.darkMode]="dark"===i,t))},Object(d.b)("div",{className:"bx--grid"},Object(d.b)("div",{className:"bx--row"},Object(d.b)("div",{className:"bx--col-lg-12"},Object(d.b)("h1",{id:"page-title",className:m.a.text},a)))))},h=a("BAC9"),O=function(e){var t=e.relativePagePath,a=e.repository,i=Object(l.useStaticQuery)("1364590287").site.siteMetadata.repository,n=a||i,r=n.baseUrl,o=n.subDirectory,c=r+"/edit/"+n.branch+o+"/src/pages"+t;return r?Object(d.b)("div",{className:"bx--row "+h.row},Object(d.b)("div",{className:"bx--col"},Object(d.b)("a",{className:h.link,href:c},"Edit this page on GitHub"))):null},j=a("FCXl"),f=a("dI71"),x=a("I8xM"),N=function(e){function t(){return e.apply(this,arguments)||this}return Object(f.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.title,a=e.tabs,i=e.slug,n=i.split("/").filter(Boolean).slice(-1)[0],r=a.map((function(e){var t,a=o()(e,{lower:!0,strict:!0}),r=a===n,c=new RegExp(n+"/?(#.*)?$"),s=i.replace(c,a);return Object(d.b)("li",{key:e,className:p()((t={},t[x.selectedItem]=r,t),x.listItem)},Object(d.b)(l.Link,{className:x.link,to:""+s},e))}));return Object(d.b)("div",{className:x.tabsContainer},Object(d.b)("div",{className:"bx--grid"},Object(d.b)("div",{className:"bx--row"},Object(d.b)("div",{className:"bx--col-lg-12 bx--col-no-gutter"},Object(d.b)("nav",{"aria-label":t},Object(d.b)("ul",{className:x.list},r))))))},t}(n.a.Component),y=a("MjG9"),w=a("CzIb"),k=a("Asxa"),v=a("OIbQ"),A=a.n(v),T=function(e){var t=e.date,a=new Date(t);return t?Object(d.b)(k.c,{className:A.a.row},Object(d.b)(k.a,null,Object(d.b)("div",{className:A.a.text},"Page last updated: ",a.toLocaleDateString("en-GB",{day:"2-digit",year:"numeric",month:"long"})))):null};t.a=function(e){var t=e.pageContext,a=e.children,i=e.location,n=e.Title,r=t.frontmatter,b=void 0===r?{}:r,p=t.relativePagePath,u=t.titleType,m=b.tabs,h=b.title,f=b.theme,x=b.description,k=b.keywords,v=b.date,A=Object(w.a)().interiorTheme,C=Object(l.useStaticQuery)("2456312558").site.pathPrefix,P=C?i.pathname.replace(C,""):i.pathname,I=m?P.split("/").filter(Boolean).slice(-1)[0]||o()(m[0],{lower:!0}):"",S=f||A;return Object(d.b)(s.a,{tabs:m,homepage:!1,theme:S,pageTitle:h,pageDescription:x,pageKeywords:k,titleType:u},Object(d.b)(g,{title:n?Object(d.b)(n,null):h,label:"label",tabs:m,theme:S}),m&&Object(d.b)(N,{title:h,slug:P,tabs:m,currentTab:I}),Object(d.b)(y.a,{padded:!0},a,Object(d.b)(O,{relativePagePath:p}),Object(d.b)(T,{date:v})),Object(d.b)(j.a,{pageContext:t,location:i,slug:P,tabs:m,currentTab:I}),Object(d.b)(c.a,null))}},"2yob":function(e,t,a){"use strict";a.r(t),a.d(t,"_frontmatter",(function(){return c})),a.d(t,"default",(function(){return p}));var i=a("wx14"),n=a("zLVn"),r=(a("q1tI"),a("7ljp")),o=a("013z"),l=(a("qKvR"),["components"]),c={},s={_frontmatter:c},b=o.a;function p(e){var t=e.components,a=Object(n.a)(e,l);return Object(r.b)(b,Object(i.a)({},s,a,{components:t,mdxType:"MDXLayout"}),Object(r.b)("h2",null,"Challenge"),Object(r.b)("p",null,"You are provided with the challenge to implement a demo that shows best practices for DevOps.\nImplement Continous Integration and Continous Deployment for an Application on Kubernetes."),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Git repository with application code and Dockerfile, Developers have access to this git repository"),Object(r.b)("li",{parentName:"ul"},"Git repository with pipeline manifest files (ie yamls) files, Operators have access to this repository"),Object(r.b)("li",{parentName:"ul"},"Git repository with application manifest (ie yaml) files, automation only have access to this repository")),Object(r.b)("h2",null,"Specifications"),Object(r.b)("span",{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"818px"}},"\n      ",Object(r.b)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"31.59722222222222%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABKElEQVQY021RuU4DMRDdH6ak5SP4Dor0NCAhAk3oSBQUEm3wsg7rPeI9fD/GjiIQYqTReObN+ZwhSvAwxpAJya0ZB1tuERJEmLWAd/grnjBHSZpgPSkY2SN7Gz1K5WC1gux7DOOAiguwnENrjXEcYZTCl7JYDR4hBMimoQU0lKY6PsPL+h3zuz3U8xOyq63GrJyguwairiCqA5SKzSXatkVRlvCDxG1xxOXG0MAJm/k9quID/WjAFxcQxSPV0Ja1QLbc7cFFnU46iB6MS1hr0naxcVRD77o7YpWzdCrLc0y0uXMO7LNB10k4b9FPEzJPxdae+Ll5ULieHSM7KRYLkkYe4wCiwxKfns4+Y3F4pCEkwgMynGyS9U5g8Vqc/ikl/ehv+S9+9r8BMYrNQ7ZZBPoAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}}),"\n  ",Object(r.b)("img",{parentName:"span",className:"gatsby-resp-image-image",alt:"overview-diagram",title:"overview-diagram",src:"/static/e0f59cda603cd30cfc3a5138da9d879c/96d67/tekton-argocd.png",srcSet:["/static/e0f59cda603cd30cfc3a5138da9d879c/7fc1e/tekton-argocd.png 288w","/static/e0f59cda603cd30cfc3a5138da9d879c/a5df1/tekton-argocd.png 576w","/static/e0f59cda603cd30cfc3a5138da9d879c/96d67/tekton-argocd.png 818w"],sizes:"(max-width: 818px) 100vw, 818px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"}),"\n    "),Object(r.b)("h3",null,"Code Git Repository"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"https://github.com/ibm-cloud-architecture/tutorial-tekton-argocd-code"},"Git repository with application code")),Object(r.b)("li",{parentName:"ul"},"Create a new git repository using this repo as ",Object(r.b)("a",{parentName:"li",href:"https://github.com/ibm-cloud-architecture/tutorial-tekton-argocd-code/generate"},"template")),Object(r.b)("li",{parentName:"ul"},"Use the ",Object(r.b)("inlineCode",{parentName:"li"},"Dockerfile")," on the root of the repository to build a container image")),Object(r.b)("h3",null,"Infra Git Repository"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"https://github.com/ibm-cloud-architecture/tutorial-tekton-argocd-infra"},"Git repository with application manifest")),Object(r.b)("li",{parentName:"ul"},"Create a new git repository using this repo as ",Object(r.b)("a",{parentName:"li",href:"https://github.com/ibm-cloud-architecture/tutorial-tekton-argocd-infra/generate"},"template")),Object(r.b)("li",{parentName:"ul"},"The directory ",Object(r.b)("inlineCode",{parentName:"li"},"ocp/yamls")," contains the application manifest files")),Object(r.b)("h3",null,"Pipeline Git Repository"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Create new repository to store pipeline resources"),Object(r.b)("li",{parentName:"ul"},"Use the ServiceAccount ",Object(r.b)("inlineCode",{parentName:"li"},"pipeline")),Object(r.b)("li",{parentName:"ul"},"Use the following guide to create a Pipeline, Tasks, and secret:",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"Create a pipeline, tasks, secrets on the target namespace"),Object(r.b)("li",{parentName:"ul"},"Git clone the source code from the App repo"),Object(r.b)("li",{parentName:"ul"},"Build a container image using the ",Object(r.b)("inlineCode",{parentName:"li"},"Dockerfile")," on the repo"),Object(r.b)("li",{parentName:"ul"},"Tag the image using the 7 first characters of the git hash corresponding to last git commit"),Object(r.b)("li",{parentName:"ul"},"Push the container image into the internal image registry on the same namespace"),Object(r.b)("li",{parentName:"ul"},"Git clone the Infra git repo"),Object(r.b)("li",{parentName:"ul"},"Update the image on the deployment yaml with the new image id that has the tag with value of the git commit"),Object(r.b)("li",{parentName:"ul"},"Git commit the changes"),Object(r.b)("li",{parentName:"ul"},"Git push the changes to the infra git repo, this should trigger argocd to pickup any changes from the infra repo.")))),Object(r.b)("h2",null,"Hints"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"The secret contains the git username and token with permission ",Object(r.b)("inlineCode",{parentName:"li"},"repo")," that gives write access to the git infra repository"),Object(r.b)("li",{parentName:"ul"},"OpenShift 4 comes with an internal image registry you can push from a Tekton task"),Object(r.b)("li",{parentName:"ul"},"The image registry url contains the service name, port, namespace, image name and tag",Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",{parentName:"pre"},"image-registry.openshift-image-registry.svc:5000/my-namespace-app/image-name:my-tag\n"))),Object(r.b)("li",{parentName:"ul"},"The image registry only handles ssl/https connections, but it uses a self sign certificate"),Object(r.b)("li",{parentName:"ul"},"You need to ignore TLS-Verify to be able to succesfully push and ignore ssl errors for example using buildah set the flag ",Object(r.b)("inlineCode",{parentName:"li"},'--tls-verify="false"'))),Object(r.b)("h2",null,"Extra Credit"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Make the pipeline to run automatically every time new code gets pushed to the Code git repository",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"Configure a Github Webhook using the new ",Object(r.b)("a",{parentName:"li",href:"https://github.com/tektoncd/triggers"},"Tekton Triggers")," listener and bindings")))),Object(r.b)("h2",null,"Solution"),Object(r.b)("p",null,"Here is one implementation as a ",Object(r.b)("a",{parentName:"p",href:"./solution"},"solution")))}p.isMDXComponent=!0},BAC9:function(e,t,a){e.exports={bxTextTruncateEnd:"EditLink-module--bx--text-truncate--end--2pqje",bxTextTruncateFront:"EditLink-module--bx--text-truncate--front--3_lIE",link:"EditLink-module--link--1qzW3",row:"EditLink-module--row--1B9Gk"}},I8xM:function(e,t,a){e.exports={bxTextTruncateEnd:"PageTabs-module--bx--text-truncate--end--267NA",bxTextTruncateFront:"PageTabs-module--bx--text-truncate--front--3xEQF",tabsContainer:"PageTabs-module--tabs-container--8N4k0",list:"PageTabs-module--list--3eFQc",listItem:"PageTabs-module--list-item--nUmtD",link:"PageTabs-module--link--1mDJ1",selectedItem:"PageTabs-module--selected-item--YPVr3"}},OIbQ:function(e,t,a){e.exports={bxTextTruncateEnd:"last-modified-date-module--bx--text-truncate--end--123zi",bxTextTruncateFront:"last-modified-date-module--bx--text-truncate--front--3xeKz",text:"last-modified-date-module--text--24m-4",row:"last-modified-date-module--row--2BquN"}},QH2O:function(e,t,a){e.exports={bxTextTruncateEnd:"PageHeader-module--bx--text-truncate--end--mZWeX",bxTextTruncateFront:"PageHeader-module--bx--text-truncate--front--3zvrI",pageHeader:"PageHeader-module--page-header--3hIan",darkMode:"PageHeader-module--dark-mode--hBrwL",withTabs:"PageHeader-module--with-tabs--3nKxA",text:"PageHeader-module--text--o9LFq"}}}]);
//# sourceMappingURL=component---src-pages-projects-project-cicd-index-mdx-05c637780ef03d03578c.js.map